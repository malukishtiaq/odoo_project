<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <!-- Modern POS Dashboard Template -->
    <t t-name="PosDashboard">
        <div class="oh_dashboards">
            <!-- Modern KPI Cards Grid -->
            <div class="modern-kpi-grid fade-in">
                <!-- Today Orders -->
                <div class="modern-kpi-card primary" t-on-click="pos_order_today">
                    <div class="kpi-content">
                        <div class="kpi-icon primary">
                            <i class="fa fa-shopping-bag"/>
                        </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Today Orders</div>
                            <div class="kpi-value"><t t-esc="state.today_sale"/></div>
                                    </div>
                                </div>
                            </div>

                <!-- Today Sales -->
                <div class="modern-kpi-card success" t-on-click="pos_order_today">
                    <div class="kpi-content">
                        <div class="kpi-icon success">
                            <i class="fa fa-dollar-sign"/>
                        </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Today Sales</div>
                            <div class="kpi-value"><t t-esc="state.today_sale_amount"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- Today Refund Orders -->
                <div class="modern-kpi-card danger" t-on-click="pos_refund_today_orders">
                    <div class="kpi-content">
                        <div class="kpi-icon danger">
                            <i class="fa fa-undo"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Today Refunds</div>
                            <div class="kpi-value"><t t-esc="state.today_refund_total"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- Total Orders -->
                <div class="modern-kpi-card primary" t-on-click="pos_order">
                    <div class="kpi-content">
                        <div class="kpi-icon primary">
                            <i class="fa fa-shopping-cart"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Total Orders</div>
                            <div class="kpi-value"><t t-esc="state.total_order_count"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- Total Sales -->
                <div class="modern-kpi-card success" t-on-click="pos_order">
                    <div class="kpi-content">
                        <div class="kpi-icon success">
                            <i class="fa fa-chart-line"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Total Sales</div>
                            <div class="kpi-value"><t t-esc="state.total_sale"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- Total Refund Orders -->
                <div class="modern-kpi-card danger" t-on-click="pos_refund_orders">
                    <div class="kpi-content">
                        <div class="kpi-icon danger">
                            <i class="fa fa-times-circle"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Total Refunds</div>
                            <div class="kpi-value"><t t-esc="state.total_refund_count"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- New Customers -->
                <div class="modern-kpi-card info" t-on-click="new_customers">
                    <div class="kpi-content">
                        <div class="kpi-icon info">
                            <i class="fa fa-user-plus"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">New Customers</div>
                            <div class="kpi-value"><t t-esc="state.new_customer_count"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- Retained Customers -->
                <div class="modern-kpi-card warning" t-on-click="retained_customers">
                    <div class="kpi-content">
                        <div class="kpi-icon warning">
                            <i class="fa fa-user-check"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Retained Customers</div>
                            <div class="kpi-value"><t t-esc="state.retained_customer_count"/></div>
                        </div>
                    </div>
                                    </div>

                <!-- Inactive Customers -->
                <div class="modern-kpi-card danger" t-on-click="inactive_customers">
                    <div class="kpi-content">
                        <div class="kpi-icon danger">
                            <i class="fa fa-user-times"/>
                                </div>
                        <div class="kpi-text">
                            <div class="kpi-title">Inactive Customers</div>
                            <div class="kpi-value"><t t-esc="state.inactive_customer_count"/></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modern Charts Section -->
            <div class="charts-section slide-in-left">
                <!-- Sales Report Chart -->
                <div class="modern-chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Sales Report</h3>
                        <div class="chart-controls">
                            <select class="modern-select" id="pos_sales" t-on-click="onclick_pos_sales">
                                <option value="">Select Period</option>
                                <option value="pos_weekly_sales">Weekly</option>
                                <option value="pos_monthly_sales">Monthly</option>
                            </select>
                        </div>
                        </div>
                    <div class="chart-container">
                        <canvas id="canvas_1" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- Sales vs Cost Card -->
                <div class="modern-chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Sales vs Cost</h3>
                        <div class="chart-controls">
                            <select class="modern-select" id="pos_sales_cost" t-on-click="onclick_pos_sales_cost">
                                <option value="">Select Period</option>
                                    <option value="pos_today_sales_cost">Today</option>
                                    <option value="pos_week_sales_cost">Week</option>
                                    <option value="pos_month_sales_cost">Month</option>
                                </select>
                            </div>
                        </div>
                    <div class="sales-cost-grid">
                        <div class="sales-cost-item sales">
                            <div class="sales-cost-label">Sales</div>
                            <div class="sales-cost-value"><t t-esc="state.sale_vs_cost[0]"/></div>
                                </div>
                        <div class="sales-cost-item cost">
                            <div class="sales-cost-label">Cost</div>
                            <div class="sales-cost-value"><t t-esc="state.sale_vs_cost[1]"/></div>
                        </div>
                        <div class="sales-cost-item profit">
                            <div class="sales-cost-label">Profit</div>
                            <div class="sales-cost-value"><t t-esc="state.sale_vs_cost[2]"/></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- POS Order Report Section -->
            <div class="pos-order-report-section slide-in-right">
                <div class="pos-report-header">
                    <h3 class="pos-report-title">POS Order Summary</h3>
                    <div class="pos-report-controls">
                        <div class="pos-date-selector">
                            <label class="date-label">Report Period</label>
                            <div class="date-inputs-inline">
                                <input type="date" class="modern-date-input" id="pos_from_date" 
                                       t-att-value="state.pos_from_date" t-on-change="onPosDateChange"/>
                                <span class="date-separator">to</span>
                                <input type="date" class="modern-date-input" id="pos_to_date" 
                                       t-att-value="state.pos_to_date" t-on-change="onPosDateChange"/>
                            </div>
                        </div>
                        <button class="modern-btn generate-btn" t-on-click="generatePosReport">
                            <i class="fa fa-chart-bar"></i> Generate Report
                        </button>
                    </div>
                </div>

                <!-- POS Report Display Area -->
                <div class="pos-report-display-area">
                    <!-- Total Sales Summary -->
                    <div class="pos-summary-cards">
                        <div class="pos-summary-card total-orders">
                            <div class="summary-icon">
                                <i class="fa fa-shopping-cart"></i>
                            </div>
                            <div class="summary-content">
                                <div class="summary-label">Total Orders</div>
                                <div class="summary-value"><t t-esc="state.pos_total_orders"/></div>
                            </div>
                        </div>
                        <div class="pos-summary-card total-amount">
                            <div class="summary-icon">
                                <i class="fa fa-dollar-sign"></i>
                            </div>
                            <div class="summary-content">
                                <div class="summary-label">Total Amount</div>
                                <div class="summary-value"><t t-esc="state.pos_total_amount"/></div>
                            </div>
                        </div>
                        <div class="pos-summary-card avg-order">
                            <div class="summary-icon">
                                <i class="fa fa-chart-line"></i>
                            </div>
                            <div class="summary-content">
                                <div class="summary-label">Average Order</div>
                                <div class="summary-value"><t t-esc="state.pos_avg_order"/></div>
                            </div>
                        </div>
                    </div>

                    <!-- Top Selling Products -->
                    <div class="top-products-section">
                        <h4 class="section-title">Top 3 Selling Products</h4>
                        <div class="top-products-list">
                            <t t-foreach="state.pos_top_products" t-as="product" t-key="product.id">
                                <div class="product-item" t-att-class="'rank-' + product.rank">
                                    <div class="product-rank">
                                        <span class="rank-number"><t t-esc="product.rank"/></span>
                                    </div>
                                    <div class="product-info">
                                        <div class="product-name"><t t-esc="product.name"/></div>
                                        <div class="product-details">
                                            <span class="quantity">Qty: <t t-esc="product.quantity"/></span>
                                            <span class="amount">Amount: <t t-esc="product.amount"/></span>
                                        </div>
                                    </div>
                                    <div class="product-chart">
                                        <div class="mini-bar" t-att-style="'width: ' + product.percentage + '%'"></div>
                                    </div>
                                </div>
                            </t>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div class="pos-report-loading" t-if="state.pos_report_loading">
                        <div class="loading-spinner"></div>
                        <p>Generating POS report...</p>
                    </div>

                    <!-- No Data State -->
                    <div class="pos-report-no-data" t-if="!state.pos_report_loading and state.pos_total_orders === 0">
                        <div class="no-data-icon">
                            <i class="fa fa-shopping-cart"></i>
                        </div>
                        <p>No POS orders found for the selected period</p>
                    </div>
                </div>
            </div>

            <!-- Accounting Reports Section -->
            <div class="accounting-reports-section slide-in-left">
                <div class="reports-header">
                    <h3 class="reports-title">Financial Reports</h3>
                    <div class="reports-controls">
                        <div class="report-date-selector">
                            <label class="date-label">Report Period</label>
                            <div class="date-inputs-inline">
                                <input type="date" class="modern-date-input" id="report_from_date" 
                                       t-att-value="state.report_from_date" t-on-change="onReportDateChange"/>
                                <span class="date-separator">to</span>
                                <input type="date" class="modern-date-input" id="report_to_date" 
                                       t-att-value="state.report_to_date" t-on-change="onReportDateChange"/>
                            </div>
                        </div>
                        <div class="report-type-selector">
                            <label class="date-label">Report Type</label>
                            <select class="modern-select" id="report_type" t-on-change="onReportTypeChange">
                                <option value="profit_loss">Profit &amp; Loss</option>
                                <option value="balance_sheet">Balance Sheet</option>
                                <option value="trial_balance">Trial Balance</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Report Display Area -->
                <div class="report-display-area">
                    <!-- Profit &amp; Loss Report -->
                    <div class="report-content" t-if="state.current_report_type === 'profit_loss'">
                        <div class="report-header">
                            <h4 class="report-title">Profit &amp; Loss Statement</h4>
                            <div class="report-period">
                                <t t-esc="state.report_from_date"/> to <t t-esc="state.report_to_date"/>
                            </div>
                        </div>
                        <div class="report-table-container">
                            <table class="modern-report-table">
                                <thead>
                                    <tr>
                                        <th>Account</th>
                                        <th>Debit</th>
                                        <th>Credit</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="state.profit_loss_data" t-as="line" t-key="line.id">
                                        <tr t-att-class="line.level === 1 ? 'report-total-row' : (line.level === 2 ? 'report-subtotal-row' : '')">
                                            <td t-att-style="'padding-left: ' + (line.level * 20) + 'px'">
                                                <t t-esc="line.name"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-esc="line.debit"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-esc="line.credit"/>
                                            </td>
                                            <td class="text-right" t-att-class="line.balance &lt; 0 ? 'text-danger' : 'text-success'">
                                                <t t-esc="line.balance"/>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Balance Sheet Report -->
                    <div class="report-content" t-if="state.current_report_type === 'balance_sheet'">
                        <div class="report-header">
                            <h4 class="report-title">Balance Sheet</h4>
                            <div class="report-period">
                                As of <t t-esc="state.report_to_date"/>
                            </div>
                        </div>
                        <div class="balance-sheet-container">
                            <div class="balance-sheet-section">
                                <h5 class="section-title">ASSETS</h5>
                                <table class="modern-report-table">
                                    <thead>
                                        <tr>
                                            <th>Account</th>
                                            <th>Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="state.balance_sheet_assets" t-as="line" t-key="line.id">
                                            <tr t-att-class="line.level === 1 ? 'report-total-row' : (line.level === 2 ? 'report-subtotal-row' : '')">
                                                <td t-att-style="'padding-left: ' + (line.level * 20) + 'px'">
                                                    <t t-esc="line.name"/>
                                                </td>
                                                <td class="text-right">
                                                    <t t-esc="line.balance"/>
                                                </td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </div>
                            <div class="balance-sheet-section">
                                <h5 class="section-title">LIABILITIES &amp; EQUITY</h5>
                                <table class="modern-report-table">
                                    <thead>
                                        <tr>
                                            <th>Account</th>
                                            <th>Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="state.balance_sheet_liabilities" t-as="line" t-key="line.id">
                                            <tr t-att-class="line.level === 1 ? 'report-total-row' : (line.level === 2 ? 'report-subtotal-row' : '')">
                                                <td t-att-style="'padding-left: ' + (line.level * 20) + 'px'">
                                                    <t t-esc="line.name"/>
                                                </td>
                                                <td class="text-right">
                                                    <t t-esc="line.balance"/>
                                                </td>
                                            </tr>
                                        </t>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Trial Balance Report -->
                    <div class="report-content" t-if="state.current_report_type === 'trial_balance'">
                        <div class="report-header">
                            <h4 class="report-title">Trial Balance</h4>
                            <div class="report-period">
                                <t t-esc="state.report_from_date"/> to <t t-esc="state.report_to_date"/>
                            </div>
                        </div>
                        <div class="report-table-container">
                            <table class="modern-report-table">
                                <thead>
                                    <tr>
                                        <th>Account</th>
                                        <th>Debit</th>
                                        <th>Credit</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="state.trial_balance_data" t-as="line" t-key="line.id">
                                        <tr t-att-class="line.level === 1 ? 'report-total-row' : (line.level === 2 ? 'report-subtotal-row' : '')">
                                            <td t-att-style="'padding-left: ' + (line.level * 20) + 'px'">
                                                <t t-esc="line.name"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-esc="line.debit"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-esc="line.credit"/>
                                            </td>
                                            <td class="text-right" t-att-class="line.balance &lt; 0 ? 'text-danger' : 'text-success'">
                                                <t t-esc="line.balance"/>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div class="report-loading" t-if="state.report_loading">
                        <div class="loading-spinner"></div>
                        <p>Generating report...</p>
                    </div>

                    <!-- No Data State -->
                    <div class="report-no-data" t-if="!state.report_loading and state.current_report_data.length === 0">
                        <div class="no-data-icon">
                            <i class="fa fa-chart-line"/>
                        </div>
                        <p>No data available for the selected period</p>
                    </div>
                </div>
            </div>

            <!-- Date Range Selector -->
            <div class="date-range-section slide-in-right">
                <div class="date-range-header">
                    <h3 class="date-range-title">Date Range Filter</h3>
                </div>
                <div class="date-inputs">
                    <div class="date-input-group">
                        <label class="date-label">From Date</label>
                        <input type="date" class="modern-date-input" id="from_date_cus" 
                               t-att-value="state.from_date" t-on-change="onDateChange"/>
                    </div>
                    <div class="date-input-group">
                        <label class="date-label">To Date</label>
                        <input type="date" class="modern-date-input" id="to_date_cus" 
                               t-att-value="state.to_date" t-on-change="onDateChange"/>
                    </div>
                    <div class="date-input-group">
                        <button class="modern-btn comprehensive-data-btn" 
                                t-on-click="() => this.showCompleteProductData(state.from_date, state.to_date)">
                            <i class="fa fa-table"></i> View All Products
                        </button>
                    </div>
                </div>
            </div>

            <!-- Target Input Section -->
            <div class="target-section slide-in-left">
                <h3 class="target-header">Monthly Target Setting</h3>
                <div class="target-form">
                    <div class="target-input-group">
                        <label class="target-label">Monthly Target Amount</label>
                        <input type="number" class="modern-input" id="float_input" 
                               step="any" placeholder="Enter Monthly Target"/>
        </div>
                    <button class="modern-btn" id="submit_target" t-on-click="onSubmitTarget">
                        Set Target
                    </button>
                </div>
            </div>

            <!-- Modern Tables Section -->
            <div class="tables-section slide-in-right">
                <!-- Top Selling Products POS -->
                <div class="modern-table-card">
                    <div class="table-header">Top Selling Products (POS)</div>
                    <table class="modern-table">
                                        <thead>
                                        <tr>
                                <th>Product Name</th>
                                <th>Sold Qty</th>
                                <th>Remaining</th>
                                            <th>Total Amount</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                            <t t-foreach="state.top_selling_product_pos" t-as="product" t-foreach-index="idxPos" t-key="idxPos">
                                <tr>
                                    <td><t t-esc="product.product_name['en_US']"/></td>
                                    <td><t t-esc="product.total_quantity"/></td>
                                    <td><t t-esc="product.available_quantity"/></td>
                                    <td><t t-esc="(product.total_quantity * product.cost).toFixed(2)"/></td>
                                            </tr>
                                        </t>
                                        </tbody>
                                    </table>
                                </div>

                <!-- Top Selling Products Inventory -->
                <div class="modern-table-card">
                    <div class="table-header">Top Selling Products (Inventory)</div>
                    <table class="modern-table">
                                        <thead>
                                        <tr>
                                <th>Product Name</th>
                                <th>Sold Qty</th>
                                <th>Remaining</th>
                                            <th>Total Amount</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                            <t t-foreach="state.top_selling_product_inv" t-as="product" t-foreach-index="idxInv" t-key="idxInv">
                                <tr>
                                    <td><t t-esc="product.product_name['en_US']"/></td>
                                    <td><t t-esc="product.total_quantity"/></td>
                                    <td><t t-esc="product.available_quantity"/></td>
                                    <td><t t-esc="(product.total_quantity * product.cost).toFixed(2)"/></td>
                                            </tr>
                                        </t>
                                        </tbody>
                                    </table>
                                </div>

                <!-- Sales by Salesperson -->
                <div class="modern-table-card">
                    <div class="table-header">Sales by Salesperson</div>
                    <table class="modern-table">
                                        <thead>
                                        <tr>
                                <th>Salesperson</th>
                                <th>Orders</th>
                                <th>Amount</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                            <t t-foreach="state.top_salesperson" t-as="salesperson" t-foreach-index="idxSp" t-key="idxSp">
                                <tr>
                                    <td><t t-esc="salesperson[0]"/></td>
                                    <td><t t-esc="salesperson[2]"/></td>
                                    <td><t t-esc="salesperson[1]"/></td>
                                            </tr>
                                        </t>
                                        </tbody>
                                    </table>
                                </div>

                <!-- Session Status -->
                <div class="modern-table-card">
                    <div class="table-header">Session Status</div>
                    <table class="modern-table">
                                        <thead>
                                        <tr>
                                <th>Session</th>
                                <th>Status</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                            <t t-foreach="state.selling_product" t-as="session" t-foreach-index="idxSess" t-key="idxSess">
                                <tr>
                                    <td><t t-esc="session['session']"/></td>
                                    <td><t t-esc="session['status']"/></td>
                                            </tr>
                                        </t>
                                        </tbody>
                                    </table>
                                </div>

                <!-- Payment Methods -->
                <div class="modern-table-card">
                    <div class="table-header">Payment Methods</div>
                    <table class="modern-table">
                                            <thead>
                                                <tr>
                                <th>Payment Method</th>
                                <th>Amount</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                            <t t-foreach="state.payment_details" t-as="payment_method" t-foreach-index="idxPay" t-key="idxPay">
                                <tr>
                                    <td><t t-esc="payment_method[0]['en_US']"/></td>
                                    <td><t t-esc="payment_method[1]"/></td>
                                                    </tr>
                                                </t>
                                            </tbody>
                                        </table>
                                    </div>

                <!-- Monthly Target Progress -->
                <div class="modern-table-card">
                    <div class="table-header">Target Progress</div>
                    <table class="modern-table">
                                        <thead>
                                            <tr>
                                <th>Period</th>
                                <th>Actual</th>
                                <th>Target</th>
                                <th>Progress</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                <td>Daily</td>
                                <td><t t-esc="state.daily_actual"/></td>
                                <td><t t-esc="state.daily_target"/></td>
                                <td><t t-esc="state.daily_percentage"/>%</td>
                                            </tr>
                                            <tr>
                                <td>Weekly</td>
                                <td><t t-esc="state.weekly_actual"/></td>
                                <td><t t-esc="state.weekly_target"/></td>
                                <td><t t-esc="state.weekly_percentage"/>%</td>
                                            </tr>
                                            <tr>
                                <td>Monthly</td>
                                <td><t t-esc="state.monthly_actual"/></td>
                                <td><t t-esc="state.monthly_target"/></td>
                                <td><t t-esc="state.monthly_percentage"/>%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                </div>
            </div>

            <!-- Monthly History Table -->
            <div class="modern-table-card slide-in-left" style="margin-top: 24px;">
                <div class="table-header">Monthly History</div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table class="modern-table">
                                        <thead>
                                            <tr>
                                                <th>Month</th>
                                <th>Sales</th>
                                                <th>Cost</th>
                                                <th>Commission</th>
                                                <th>Gross Profit</th>
                                                <th>Expense</th>
                                                <th>Net Income</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                             <t t-foreach="state.history_data" t-as="hd" t-foreach-index="idxHist" t-key="idxHist">
                                                <tr>
                                                    <td><t t-esc="hd.name"/></td>
                                                    <td><t t-esc="hd.sale"/></td>
                                                    <td><t t-esc="hd.cost"/></td>
                                                    <td><t t-esc="hd.commission"/></td>
                                                    <td><t t-esc="hd.gross_profit"/></td>
                                                    <td><t t-esc="hd.expense"/></td>
                                                    <td><t t-esc="hd.net_income"/></td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

            <!-- Pricing Scenarios Section -->
            <div class="pricing-scenarios-section slide-in-right" style="margin-top: 24px;">
                <div class="modern-table-card">
                    <div class="table-header">
                        <i class="fa fa-calculator" style="margin-right: 8px;"></i>
                        Pricing Scenarios (Previous Months)
                    </div>
                    
                    <!-- Controls Section -->
                    <div class="pricing-controls" style="padding: 16px; border-bottom: 1px solid #e0e0e0;">
                        <!-- Date Range Picker -->
                        <div class="control-group" style="margin-bottom: 16px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 500;">Date Range:</label>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 4px; font-size: 12px; color: #666;">From Date:</label>
                                    <input type="date" 
                                           class="form-control" 
                                           t-att-value="state.pricing_scenarios_start_date"
                                           t-on-change="onPricingScenariosStartDateChange"
                                           style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;"/>
                                </div>
                                <div style="flex: 1;">
                                    <label style="display: block; margin-bottom: 4px; font-size: 12px; color: #666;">To Date:</label>
                                    <input type="date" 
                                           class="form-control" 
                                           t-att-value="state.pricing_scenarios_end_date"
                                           t-on-change="onPricingScenariosEndDateChange"
                                           style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;"/>
                                </div>
                                <div style="flex: 0 0 auto;">
                                    <button class="btn btn-primary" 
                                            t-on-click="onPricingScenariosDateRangeChange"
                                            t-att-disabled="!state.pricing_scenarios_start_date or !state.pricing_scenarios_end_date"
                                            style="padding: 8px 16px; margin-top: 20px;">
                                        Apply
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Navigation -->
                        <div class="tab-navigation" style="margin-bottom: 16px;">
                            <button class="tab-button" 
                                    t-att-class="state.pricing_scenarios_current_tab === 'break_even' ? 'active' : ''"
                                    t-on-click="() => this.onPricingScenariosTabChange('break_even')">
                                Break Even
                            </button>
                            <button class="tab-button" 
                                    t-att-class="state.pricing_scenarios_current_tab === 'net_10k' ? 'active' : ''"
                                    t-on-click="() => this.onPricingScenariosTabChange('net_10k')">
                                +10,000 AED Net
                            </button>
                            <button class="tab-button" 
                                    t-att-class="state.pricing_scenarios_current_tab === 'net_custom' ? 'active' : ''"
                                    t-on-click="() => this.onPricingScenariosTabChange('net_custom')">
                                +Custom Net
                            </button>
                        </div>

                        <!-- Weighting Mode Toggle (for target scenarios) -->
                        <div class="control-group" t-if="state.pricing_scenarios_current_tab !== 'break_even'" style="margin-bottom: 16px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 500;">Uplift Method:</label>
                            <div class="toggle-group">
                                <button class="toggle-button" 
                                        t-att-class="state.pricing_scenarios_weighting_mode === 'uniform' ? 'active' : ''"
                                        t-on-click="() => this.onPricingScenariosWeightingModeChange('uniform')">
                                    Uniform
                                </button>
                                <button class="toggle-button" 
                                        t-att-class="state.pricing_scenarios_weighting_mode === 'weighted' ? 'active' : ''"
                                        t-on-click="() => this.onPricingScenariosWeightingModeChange('weighted')">
                                    Weighted
                                </button>
                            </div>
                        </div>

                        <!-- Custom Target Input -->
                        <div class="control-group" t-if="state.pricing_scenarios_current_tab === 'net_custom'" style="margin-bottom: 16px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 500;">Target Net Profit (AED):</label>
                            <div class="input-group">
                                <input type="number" 
                                       class="form-control" 
                                       t-att-value="state.pricing_scenarios_custom_target"
                                       t-on-change="(ev) => this.onPricingScenariosCustomTargetChange(ev.target.value)"
                                       placeholder="Enter target amount"/>
                                <button class="btn btn-primary" 
                                        t-on-click="calculateCustomNetScenario"
                                        t-att-disabled="state.pricing_scenarios_loading or state.pricing_scenarios_available_months.length === 0">
                                    <i class="fa fa-calculator" t-if="!state.pricing_scenarios_loading"/>
                                    <i class="fa fa-spinner fa-spin" t-if="state.pricing_scenarios_loading"/>
                                    Calculate
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Card -->
                    <div class="pricing-summary" t-if="state.pricing_scenarios_data and state.pricing_scenarios_data.totals" style="padding: 16px; background: #f8f9fa; border-bottom: 1px solid #e0e0e0;">
                        <div class="summary-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
                            <div class="summary-item">
                                <div class="summary-label">Revenue (R)</div>
                                <div class="summary-value" t-esc="formatPricingCurrency(state.pricing_scenarios_data.totals?.revenue || 0)"/>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Gross Profit (G)</div>
                                <div class="summary-value" t-esc="formatPricingCurrency(state.pricing_scenarios_data.totals?.gross_profit || 0)"/>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Expenses (E)</div>
                                <div class="summary-value" t-esc="formatPricingCurrency(state.pricing_scenarios_data.totals?.expenses || 0)"/>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Net Profit (N)</div>
                                <div class="summary-value" t-esc="formatPricingCurrency(state.pricing_scenarios_data.totals?.net_income || 0)"/>
                            </div>
                            <div class="summary-item">
                                <div class="summary-label">Min Uplift</div>
                                <div class="summary-value" t-esc="formatPricingPercentage((state.pricing_scenarios_data.totals?.min_uplift || 0) * 100)"/>
                            </div>
                        </div>
                    </div>

                    <!-- No Data Message -->
                    <div class="no-data-message" t-if="!state.pricing_scenarios_data or !state.pricing_scenarios_data.totals" 
                         style="padding: 32px; text-align: center; color: #666; background: #f8f9fa; border: 1px solid #e0e0e0; margin: 16px;">
                        <i class="fa fa-info-circle" style="font-size: 24px; margin-bottom: 12px; display: block;"></i>
                        <div style="font-size: 16px; margin-bottom: 8px;">No pricing scenarios data available</div>
                        <div style="font-size: 14px;">Please select a date range and click Apply to calculate pricing scenarios.</div>
                    </div>

                    <!-- Error Message -->
                    <div class="error-message" t-if="state.pricing_scenarios_error" 
                         style="padding: 32px; text-align: center; color: #721c24; background: #f8d7da; border: 1px solid #f5c6cb; margin: 16px; border-radius: 4px;">
                        <i class="fa fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 12px; display: block;"></i>
                        <div style="font-size: 16px; margin-bottom: 8px; font-weight: 500;">Pricing Scenarios Error</div>
                        <div style="font-size: 14px;" t-esc="state.pricing_scenarios_error"/>
                        <div style="font-size: 12px; margin-top: 8px; color: #856404;">
                            <strong>Note:</strong> The date range feature is currently not available. Please use the original month-based pricing scenarios instead.
                        </div>
                    </div>

                    <!-- Banners -->
                    <div class="pricing-banners" t-if="state.pricing_scenarios_data and state.pricing_scenarios_current_tab !== 'break_even'">
                        <div class="banner" t-if="getCurrentScenarioMetadata() and getCurrentScenarioMetadata().unrealistic" 
                             style="background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; padding: 12px; margin: 16px; border-radius: 4px;">
                            <i class="fa fa-exclamation-triangle" style="margin-right: 8px;"></i>
                            Target is unrealistic on last month's volumes. Consider growth actions.
                        </div>
                        <div class="banner" t-if="getCurrentScenarioMetadata() and getCurrentScenarioMetadata().x" 
                             style="background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; padding: 12px; margin: 16px; border-radius: 4px;">
                            <i class="fa fa-info-circle" style="margin-right: 8px;"></i>
                            Required uniform uplift: <strong t-esc="formatPricingPercentage(getCurrentScenarioMetadata().x * 100)"/>
                        </div>
                        <div class="banner" t-if="getCurrentScenarioMetadata() and getCurrentScenarioMetadata().x_range" 
                             style="background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; padding: 12px; margin: 16px; border-radius: 4px;">
                            <i class="fa fa-info-circle" style="margin-right: 8px;"></i>
                            Weighted uplift range: <strong t-esc="formatPricingPercentage(getCurrentScenarioMetadata().x_range[0])"/> to <strong t-esc="formatPricingPercentage(getCurrentScenarioMetadata().x_range[1])"/>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div class="error-message" t-if="state.pricing_scenarios_error" 
                         style="background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 12px; margin: 16px; border-radius: 4px;">
                        <i class="fa fa-exclamation-circle" style="margin-right: 8px;"></i>
                        <t t-esc="state.pricing_scenarios_error"/>
                    </div>

                    <!-- Loading State -->
                    <div class="loading-state" t-if="state.pricing_scenarios_loading" 
                         style="text-align: center; padding: 40px;">
                        <i class="fa fa-spinner fa-spin" style="font-size: 24px; color: #007bff;"></i>
                        <div style="margin-top: 8px;">Loading pricing scenarios...</div>
                    </div>

                    <!-- Data Table -->
                    <div class="pricing-table" t-if="state.pricing_scenarios_data and !state.pricing_scenarios_loading">
                        <div style="max-height: 500px; overflow-y: auto;">
                            <table class="modern-table">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Qty</th>
                                        <th>Cost</th>
                                        <th>Real Price</th>
                                        <th t-if="state.pricing_scenarios_current_tab === 'break_even'">Break-even Price</th>
                                        <th t-if="state.pricing_scenarios_current_tab !== 'break_even'">Target Price</th>
                                        <th t-if="state.pricing_scenarios_current_tab === 'break_even'">Diff</th>
                                        <th t-if="state.pricing_scenarios_current_tab === 'break_even'">Diff %</th>
                                        <th t-if="state.pricing_scenarios_current_tab !== 'break_even'">% Change</th>
                                        <th t-if="state.pricing_scenarios_current_tab !== 'break_even'">Margin After</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="getCurrentScenarioData()" t-as="row" t-key="row_index">
                                        <tr t-att-class="row.price_target &lt; row.cost ? 'below-cost' : (row.margin_after &lt; 2 ? 'near-cost' : '')">
                                            <td><t t-esc="row.product"/></td>
                                            <td><t t-esc="row.qty"/></td>
                                            <td><t t-esc="formatPricingCurrency(row.cost)"/></td>
                                            <td><t t-esc="formatPricingCurrency(row.price_real)"/></td>
                                            <td><t t-esc="formatPricingCurrency(row.price_target)"/></td>
                                            <t t-if="state.pricing_scenarios_current_tab === 'break_even'">
                                                <td><t t-esc="formatPricingCurrency(row.diff)"/></td>
                                                <td><t t-esc="formatPricingPercentage(row.diff_pct)"/></td>
                                            </t>
                                            <t t-if="state.pricing_scenarios_current_tab !== 'break_even'">
                                                <td><t t-esc="formatPricingPercentage(row.pct)"/></td>
                                                <td><t t-esc="formatPricingPercentage(row.margin_after)"/></td>
                                            </t>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="pricing-actions" t-if="state.pricing_scenarios_data and !state.pricing_scenarios_loading and state.pricing_scenarios_current_tab !== 'break_even'" 
                         style="padding: 16px; text-align: center; border-top: 1px solid #e0e0e0;">
                        <button class="btn btn-info" 
                                style="margin-right: 12px; padding: 10px 20px; font-size: 14px; font-weight: 500;"
                                t-on-click="previewPricingChanges">
                            <i class="fa fa-eye" style="margin-right: 6px;"></i>
                            Preview Changes
                        </button>
                        <button class="btn btn-success" 
                                style="padding: 12px 24px; font-size: 16px; font-weight: 500;"
                                t-on-click="applyPricingChanges">
                            <i class="fa fa-check" style="margin-right: 8px;"></i>
                            Apply <t t-esc="state.pricing_scenarios_weighting_mode === 'uniform' ? 'Uniform' : 'Weighted'"/> Changes
                        </button>
                    </div>
                </div>
            </div>
                        </div>
    </t>
</templates>